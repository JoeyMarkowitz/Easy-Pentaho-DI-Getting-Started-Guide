<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Pdi getting started guide by JoeyMarkowitz</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Pdi getting started guide</h1>
        <p>Getting started guide for Pentaho Community Data Integration</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/JoeyMarkowitz/pdi_getting_started_guide" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/JoeyMarkowitz/pdi_getting_started_guide/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/JoeyMarkowitz/pdi_getting_started_guide/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <p>Easy install guide for getting a simple base install of Pentaho Community Data Integration software up and running</p>

<h2>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>This guide will get you up and running with a pentaho data integration installation so you can get to what is important quickly, building transforms!</p>

<p>postgres is natively supported by pentaho (easiest way to get started).  we are going to setup pentaho data integration with a test job that will run every hour and execute a test transformation.  the data integration server (carte) will link to a repository in a postgres db.  </p>

<h3>
<a id="pentaho-software" class="anchor" href="#pentaho-software" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pentaho Software</h3>

<ul>
<li>spoon   - desktop app</li>
<li>pan     - CLI execute transforms or export repository to xml file (local)</li>
<li>kitchen - CLI execute jobs (local)</li>
<li>carte   - remote execute jobs &amp; transforms</li>
</ul>

<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<h3>
<a id="setup-new-user-in-linux-to-run-pdi" class="anchor" href="#setup-new-user-in-linux-to-run-pdi" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup new user in linux to run PDI</h3>

<p>create new user <strong>pentaho</strong> on the remote server to run the carte server</p>

<h3>
<a id="install-pentaho-data-integration-client" class="anchor" href="#install-pentaho-data-integration-client" aria-hidden="true"><span class="octicon octicon-link"></span></a>install Pentaho data integration client</h3>

<p>as of 2015.03.10 this is the download location of the pentane community version
<a href="http://community.pentaho.com/projects/data-integration/">http://community.pentaho.com/projects/data-integration/</a>
this file extracted into a folder called data-integration</p>

<h3>
<a id="install-postgres" class="anchor" href="#install-postgres" aria-hidden="true"><span class="octicon octicon-link"></span></a>install postgres</h3>

<h4>
<a id="centos" class="anchor" href="#centos" aria-hidden="true"><span class="octicon octicon-link"></span></a>centos</h4>

<p>###
  # INSTALL
  ###
  # source: <a href="https://wiki.postgresql.org/wiki/YUM_Installation">https://wiki.postgresql.org/wiki/YUM_Installation</a>
  # postgresql92 - PostgreSQL client programs and libraries
  # postgresql92-server - The programs needed to create and run a PostgreSQL server</p>

<pre><code>sudo yum install postgresql92 postgresql92-server postgresql92-contrib
sudo service postgresql-9.2 initdb
</code></pre>

<h4>
<a id="ubuntu" class="anchor" href="#ubuntu" aria-hidden="true"><span class="octicon octicon-link"></span></a>ubuntu</h4>

<p>TBD</p>

<h2>
<a id="configure" class="anchor" href="#configure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configure</h2>

<h3>
<a id="postgres-server" class="anchor" href="#postgres-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>Postgres Server</h3>

<h4>
<a id="update-connection-permissions" class="anchor" href="#update-connection-permissions" aria-hidden="true"><span class="octicon octicon-link"></span></a>update connection permissions</h4>

<pre><code># File: (/var/lib/pgsql/9.2/data/pg_hba.conf)
# add the following to the config
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
host    all             all             0.0.0.0/0               md5
</code></pre>

<h4>
<a id="update-port-and-listen-to-external-ip-addresses" class="anchor" href="#update-port-and-listen-to-external-ip-addresses" aria-hidden="true"><span class="octicon octicon-link"></span></a>update port and listen to external ip addresses</h4>

<pre><code># File: (/var/lib/pgsql/9.2/data/postgresql.conf)
listen_addresses = '*'              # what IP address(es) to listen on;
                                    # comma-separated list of addresses;
                                    # defaults to 'localhost'; use '*' for all
                                    # (change requires restart)
port = 5433                         # (change requires restart)
</code></pre>

<p>sudo service postgresql-9.2 restart</p>

<p>###
  # SETUP DATABASE
  ###
  sudo postgres
  psql
  CREATE DATABASE pdi_repository;
  CREATE USER pentaho LOGIN PASSWORD 'pentahopassword';     #defaults with login permission enabled
  GRANT ALL ON DATABASE pdi_repository TO pentaho;</p>

<p>#list databases with \l;
  #list tables with \dt;
  #list roles with \du;</p>

<p>Summary Connection Info
IP: localhost or 127.0.0.1
PORT: 5432 (default)
USR: pentaho
PWD: pentahopassword
DB: pdi_repository</p>

<h1>
<a id="create-data-integration-repository-postgres" class="anchor" href="#create-data-integration-repository-postgres" aria-hidden="true"><span class="octicon octicon-link"></span></a>create data integration repository (postgres)</h1>

<p>in spoon
1) go to the Repository Connections Dialog (Tools &gt; Repository &gt; Connect or command-E)
2) create new repository (click green + in top right)
3) select the type of repository to create ("Kettle database repository")
4) create a new db connection (click NEW)
5) see screen shot
Section in top left: General
Connection Name: localhost_postgres_db
Connection Type: PostgreSQL
Host Name: localhost (ip from previous section)
Database Name: pdi_repository (from previous section)
Port Number: 5432
User Name: pentaho (from previous section)
Password: pentahopassword (from previous section)</p>

<p>create db connection
create new db in postgres called xyz
connect to pg db and create repository
  this will create the repository tables in the database and populate the ~/.kettle/repositories.xml file</p>

<p>import repository.xml</p>

<h1>
<a id="setup-slave-server-connection-in-spoon" class="anchor" href="#setup-slave-server-connection-in-spoon" aria-hidden="true"><span class="octicon octicon-link"></span></a>setup slave server connection in spoon</h1>

<p>click slave tab
click green +
Server name: Some Slave Server Name
Hostname or IP address: localhost
Port: 8081
Web App Name (required for DI Server): BLANK
Username: cluster
Password: cluster
Is the master: checked</p>

<h1>
<a id="setup-slave-server-carte" class="anchor" href="#setup-slave-server-carte" aria-hidden="true"><span class="octicon octicon-link"></span></a>setup slave server (carte)</h1>

<p>on the remote computer where carte will run, put the configuration.xml file into ~/data-integration/configuration.xml</p>

<p>start slave server
./carte.sh configuration.xml</p>

<h1>
<a id="test-slave-server-up-and-running" class="anchor" href="#test-slave-server-up-and-running" aria-hidden="true"><span class="octicon octicon-link"></span></a>test slave server up and running</h1>

<p>http://localhost:8081/kettle/status/</p>

<p>default carte login
USR: cluster
PWD: cluster</p>

<h1>
<a id="test-setup" class="anchor" href="#test-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>test setup</h1>

<p>Create new transform
  to keep things simple create a select now() in table input, and write that to a db with table output</p>

<p>create job to call transform with a start and 
curl --user cluster:cluster http://localhost:8081/kettle/runJob/?job=/cron_hourly&amp;level=Debug</p>

<p>default repository login
USR: admin
PWD: admin</p>

<p>default carte login
USR: cluster
PWD: cluster</p>

<p>run the job remotely on carte via spoon</p>

<h1>
<a id="check-db-updated" class="anchor" href="#check-db-updated" aria-hidden="true"><span class="octicon octicon-link"></span></a>check db updated</h1>

<p>select * from test_new_pentaho</p>

<h1>
<a id="configure-carte-to-access-repository" class="anchor" href="#configure-carte-to-access-repository" aria-hidden="true"><span class="octicon octicon-link"></span></a>configure carte to access repository</h1>

<p>copy ~/.kettle/repository.xml to data-integration folder on the remote server where carte will run</p>

<p>Other info
.kettle/shared.xml  - shared db connections</p>

<h1>
<a id="configure-carte-to-start-with-init-script-on-system-boot" class="anchor" href="#configure-carte-to-start-with-init-script-on-system-boot" aria-hidden="true"><span class="octicon octicon-link"></span></a>configure carte to start with init script on system boot</h1>

<p><a href="http://techarena51.com/index.php/how-to-create-an-init-script-on-centos-6/">http://techarena51.com/index.php/how-to-create-an-init-script-on-centos-6/</a></p>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/JoeyMarkowitz">JoeyMarkowitz</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-61210146-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>